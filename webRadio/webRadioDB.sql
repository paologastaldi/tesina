-- MySQL Script generated by MySQL Workbench
-- 05/18/16 17:26:09
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema webradio
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `webradio` ;

-- -----------------------------------------------------
-- Schema webradio
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `webradio` DEFAULT CHARACTER SET utf8 ;
SHOW WARNINGS;
USE `webradio` ;

-- -----------------------------------------------------
-- Table `webradio`.`Genres`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`Genres` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`Genres` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(30) NOT NULL,
  `inputDate` DATE NOT NULL,
  `thumbnail` VARCHAR(80) NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE UNIQUE INDEX `name_UNIQUE` ON `webradio`.`Genres` (`name` ASC);

SHOW WARNINGS;
CREATE UNIQUE INDEX `ID_UNIQUE` ON `webradio`.`Genres` (`ID` ASC);

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `webradio`.`Channels`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`Channels` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`Channels` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(30) NOT NULL,
  `description` VARCHAR(140) NOT NULL,
  `activePlaylistID` INT UNSIGNED NULL,
  `startWorkabilityDate` DATE NULL,
  `inputDate` DATE NOT NULL,
  `genreID` INT UNSIGNED NOT NULL,
  `thumbnail` VARCHAR(80) NULL,
  `active` TINYINT(1) NULL DEFAULT 0,
  PRIMARY KEY (`ID`),
  CONSTRAINT `fk_Channels_Genres1`
    FOREIGN KEY (`genreID`)
    REFERENCES `webradio`.`Genres` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE UNIQUE INDEX `name_UNIQUE` ON `webradio`.`Channels` (`name` ASC);

SHOW WARNINGS;
CREATE INDEX `fk_Channels_Genres1_idx` ON `webradio`.`Channels` (`genreID` ASC);

SHOW WARNINGS;
CREATE UNIQUE INDEX `ID_UNIQUE` ON `webradio`.`Channels` (`ID` ASC);

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `webradio`.`Albums`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`Albums` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`Albums` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `title` VARCHAR(30) NOT NULL,
  `inputDate` DATE NOT NULL,
  `channelID` INT UNSIGNED NOT NULL,
  `thumbnail` VARCHAR(80) NULL,
  PRIMARY KEY (`ID`),
  CONSTRAINT `fk_Albums_Channels1`
    FOREIGN KEY (`channelID`)
    REFERENCES `webradio`.`Channels` (`ID`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE INDEX `fk_Albums_Channels1_idx` ON `webradio`.`Albums` (`channelID` ASC);

SHOW WARNINGS;
CREATE UNIQUE INDEX `ID_UNIQUE` ON `webradio`.`Albums` (`ID` ASC);

SHOW WARNINGS;
CREATE UNIQUE INDEX `albumChannel` ON `webradio`.`Albums` (`ID` ASC, `title` ASC);

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `webradio`.`Tracks`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`Tracks` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`Tracks` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `title` VARCHAR(30) NOT NULL,
  `author` VARCHAR(30) NOT NULL,
  `filename` VARCHAR(80) NOT NULL,
  `inputDate` DATE NOT NULL,
  `albumID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ID`),
  CONSTRAINT `fk_Tracks_Albums1`
    FOREIGN KEY (`albumID`)
    REFERENCES `webradio`.`Albums` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE INDEX `fk_Tracks_Albums1_idx` ON `webradio`.`Tracks` (`albumID` ASC);

SHOW WARNINGS;
CREATE UNIQUE INDEX `ID_UNIQUE` ON `webradio`.`Tracks` (`ID` ASC);

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `webradio`.`Users`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`Users` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`Users` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `firstName` VARCHAR(50) NULL,
  `lastName` VARCHAR(50) NULL,
  `password` VARCHAR(64) NOT NULL,
  `email` VARCHAR(50) NOT NULL,
  `inputDate` DATE NOT NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE UNIQUE INDEX `email_UNIQUE` ON `webradio`.`Users` (`email` ASC);

SHOW WARNINGS;
CREATE UNIQUE INDEX `ID_UNIQUE` ON `webradio`.`Users` (`ID` ASC);

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `webradio`.`Roles`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`Roles` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`Roles` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `description` VARCHAR(45) NOT NULL,
  `systemChannel` TINYINT(1) NOT NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE UNIQUE INDEX `ID_UNIQUE` ON `webradio`.`Roles` (`ID` ASC);

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `webradio`.`ChannelMembers`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`ChannelMembers` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`ChannelMembers` (
  `channelID` INT UNSIGNED NOT NULL,
  `userID` INT UNSIGNED NOT NULL,
  `roleID` INT UNSIGNED NOT NULL,
  `inputDate` DATE NOT NULL,
  PRIMARY KEY (`channelID`, `userID`, `roleID`),
  CONSTRAINT `fk_ChannelMembers_User1`
    FOREIGN KEY (`userID`)
    REFERENCES `webradio`.`Users` (`ID`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ChannelMembers_Channel1`
    FOREIGN KEY (`channelID`)
    REFERENCES `webradio`.`Channels` (`ID`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_UtentiChannel_Ruoli1`
    FOREIGN KEY (`roleID`)
    REFERENCES `webradio`.`Roles` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE INDEX `fk_ChannelMembers_Channel1_idx` ON `webradio`.`ChannelMembers` (`channelID` ASC);

SHOW WARNINGS;
CREATE INDEX `fk_UtentiChannel_Ruoli1_idx` ON `webradio`.`ChannelMembers` (`roleID` ASC);

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `webradio`.`SystemMembers`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`SystemMembers` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`SystemMembers` (
  `userID` INT UNSIGNED NOT NULL,
  `roleID` INT UNSIGNED NOT NULL,
  `inputDate` DATE NOT NULL,
  PRIMARY KEY (`userID`, `roleID`),
  CONSTRAINT `fk_SystemMembers_User1`
    FOREIGN KEY (`userID`)
    REFERENCES `webradio`.`Users` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_UtentiSistema_Ruoli1`
    FOREIGN KEY (`roleID`)
    REFERENCES `webradio`.`Roles` (`ID`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE INDEX `fk_UtentiSistema_Ruoli1_idx` ON `webradio`.`SystemMembers` (`roleID` ASC);

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `webradio`.`ListPlaylists`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`ListPlaylists` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`ListPlaylists` (
  `playlistID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `channelID` INT UNSIGNED NOT NULL,
  `creatorUserID` INT UNSIGNED NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  `inputDate` DATE NOT NULL,
  PRIMARY KEY (`playlistID`),
  CONSTRAINT `fk_PlaylistList_User1`
    FOREIGN KEY (`creatorUserID`)
    REFERENCES `webradio`.`Users` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_PlaylistList_Channel1`
    FOREIGN KEY (`channelID`)
    REFERENCES `webradio`.`Channels` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE UNIQUE INDEX `playlistID_UNIQUE` ON `webradio`.`ListPlaylists` (`playlistID` ASC);

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `webradio`.`Playlists`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`Playlists` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`Playlists` (
  `playlistID` INT UNSIGNED NOT NULL,
  `order` INT UNSIGNED NOT NULL,
  `trackID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`playlistID`, `order`),
  CONSTRAINT `fk_Playlist_Track1`
    FOREIGN KEY (`trackID`)
    REFERENCES `webradio`.`Tracks` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Playlists_ListPlaylists1`
    FOREIGN KEY (`playlistID`)
    REFERENCES `webradio`.`ListPlaylists` (`playlistID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE INDEX `fk_Playlist_Track1_idx` ON `webradio`.`Playlists` (`trackID` ASC);

SHOW WARNINGS;
CREATE INDEX `fk_Playlists_ListPlaylists1_idx` ON `webradio`.`Playlists` (`playlistID` ASC);

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `webradio`.`Logs`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`Logs` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`Logs` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `userID` INT UNSIGNED NOT NULL,
  `inputDate` DATE NOT NULL,
  `description` TEXT(2048) NOT NULL,
  PRIMARY KEY (`ID`),
  CONSTRAINT `fk_Log_Utenti1`
    FOREIGN KEY (`userID`)
    REFERENCES `webradio`.`Users` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE INDEX `fk_Log_Utenti1_idx` ON `webradio`.`Logs` (`userID` ASC);

SHOW WARNINGS;
CREATE UNIQUE INDEX `ID_UNIQUE` ON `webradio`.`Logs` (`ID` ASC);

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `webradio`.`FavouriteChannels`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`FavouriteChannels` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`FavouriteChannels` (
  `userID` INT UNSIGNED NOT NULL,
  `channelID` INT UNSIGNED NOT NULL,
  `inputDate` DATE NOT NULL,
  PRIMARY KEY (`userID`, `channelID`),
  CONSTRAINT `fk_ChannelPreferiti_Utenti1`
    FOREIGN KEY (`userID`)
    REFERENCES `webradio`.`Users` (`ID`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ChannelPreferiti_Channel1`
    FOREIGN KEY (`channelID`)
    REFERENCES `webradio`.`Channels` (`ID`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE INDEX `fk_ChannelPreferiti_Channel1_idx` ON `webradio`.`FavouriteChannels` (`channelID` ASC);

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `webradio`.`Permissions`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`Permissions` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`Permissions` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `description` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE UNIQUE INDEX `description_UNIQUE` ON `webradio`.`Permissions` (`description` ASC);

SHOW WARNINGS;
CREATE UNIQUE INDEX `ID_UNIQUE` ON `webradio`.`Permissions` (`ID` ASC);

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `webradio`.`BroadcastedQualities`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`BroadcastedQualities` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`BroadcastedQualities` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `description` VARCHAR(45) NOT NULL,
  `bitDepth` INT NULL DEFAULT 16,
  `bitRate` INT NOT NULL,
  `sampleRate` INT NOT NULL DEFAULT 44100,
  `channels` INT NOT NULL DEFAULT 2,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE UNIQUE INDEX `ID_UNIQUE` ON `webradio`.`BroadcastedQualities` (`ID` ASC);

SHOW WARNINGS;

-- -----------------------------------------------------
-- Table `webradio`.`RolesPermissions`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `webradio`.`RolesPermissions` ;

SHOW WARNINGS;
CREATE TABLE IF NOT EXISTS `webradio`.`RolesPermissions` (
  `roleID` INT UNSIGNED NOT NULL,
  `permissionID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`roleID`, `permissionID`),
  CONSTRAINT `fk_RuoliPermessi_Ruoli1`
    FOREIGN KEY (`roleID`)
    REFERENCES `webradio`.`Roles` (`ID`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_RuoliPermessi_Permessi1`
    FOREIGN KEY (`permissionID`)
    REFERENCES `webradio`.`Permissions` (`ID`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;

SHOW WARNINGS;
CREATE INDEX `fk_RuoliPermessi_Ruoli1_idx` ON `webradio`.`RolesPermissions` (`roleID` ASC);

SHOW WARNINGS;
CREATE INDEX `fk_RuoliPermessi_Permessi1_idx` ON `webradio`.`RolesPermissions` (`permissionID` ASC);

SHOW WARNINGS;

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `webradio`.`Users`
-- -----------------------------------------------------
START TRANSACTION;
USE `webradio`;
INSERT INTO `webradio`.`Users` (`ID`, `firstName`, `lastName`, `password`, `email`, `inputDate`) VALUES (1, 'System', NULL, DEFAULT, 'system@system', DEFAULT);

COMMIT;


-- -----------------------------------------------------
-- Data for table `webradio`.`Roles`
-- -----------------------------------------------------
START TRANSACTION;
USE `webradio`;
INSERT INTO `webradio`.`Roles` (`ID`, `description`, `systemChannel`) VALUES (1, 'administrator', 1);
INSERT INTO `webradio`.`Roles` (`ID`, `description`, `systemChannel`) VALUES (2, 'administrator', 0);

COMMIT;


-- -----------------------------------------------------
-- Data for table `webradio`.`SystemMembers`
-- -----------------------------------------------------
START TRANSACTION;
USE `webradio`;
INSERT INTO `webradio`.`SystemMembers` (`userID`, `roleID`, `inputDate`) VALUES (1, 1, DEFAULT);

COMMIT;


-- -----------------------------------------------------
-- Data for table `webradio`.`Permissions`
-- -----------------------------------------------------
START TRANSACTION;
USE `webradio`;
INSERT INTO `webradio`.`Permissions` (`ID`, `description`) VALUES (1, 'members');
INSERT INTO `webradio`.`Permissions` (`ID`, `description`) VALUES (2, 'logs');
INSERT INTO `webradio`.`Permissions` (`ID`, `description`) VALUES (3, 'channels');
INSERT INTO `webradio`.`Permissions` (`ID`, `description`) VALUES (4, 'settings');
INSERT INTO `webradio`.`Permissions` (`ID`, `description`) VALUES (5, 'albums');
INSERT INTO `webradio`.`Permissions` (`ID`, `description`) VALUES (6, 'playlists');
INSERT INTO `webradio`.`Permissions` (`ID`, `description`) VALUES (7, 'roles');
INSERT INTO `webradio`.`Permissions` (`ID`, `description`) VALUES (8, 'genres');

COMMIT;


-- -----------------------------------------------------
-- Data for table `webradio`.`BroadcastedQualities`
-- -----------------------------------------------------
START TRANSACTION;
USE `webradio`;
INSERT INTO `webradio`.`BroadcastedQualities` (`ID`, `description`, `bitDepth`, `bitRate`, `sampleRate`, `channels`) VALUES (1, 'LQ', NULL, 128, 44100, 2);
INSERT INTO `webradio`.`BroadcastedQualities` (`ID`, `description`, `bitDepth`, `bitRate`, `sampleRate`, `channels`) VALUES (2, 'MQ', NULL, 192, 44100, 2);
INSERT INTO `webradio`.`BroadcastedQualities` (`ID`, `description`, `bitDepth`, `bitRate`, `sampleRate`, `channels`) VALUES (3, 'HQ', NULL, 256, 44100, 2);
INSERT INTO `webradio`.`BroadcastedQualities` (`ID`, `description`, `bitDepth`, `bitRate`, `sampleRate`, `channels`) VALUES (4, 'HQ+', NULL, 320, 44100, DEFAULT);

COMMIT;


-- -----------------------------------------------------
-- Data for table `webradio`.`RolesPermissions`
-- -----------------------------------------------------
START TRANSACTION;
USE `webradio`;
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (1, 1);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (1, 2);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (1, 3);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (1, 4);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (1, 5);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (1, 6);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (1, 7);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (1, 8);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (2, 1);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (2, 2);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (2, 3);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (2, 4);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (2, 5);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (2, 6);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (2, 7);
INSERT INTO `webradio`.`RolesPermissions` (`roleID`, `permissionID`) VALUES (2, 8);

COMMIT;

